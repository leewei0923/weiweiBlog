# ä¼Ÿä¼Ÿå°ä¸–ç•Œ


## å¼€å§‹

```sh
    git clone https://github.com/leewei0923/weiweibolg.git

    cd weiweiblog

    npm install 

    npm start
```

## å‰è¨€

æ—©å°±æœ‰äº†è‡ªå·±å†™ä¸€ä¸ªä¸ªäººåšå®¢çš„æƒ³æ³•äº†ï¼Œä»¥å‰æ˜¯æƒ³ç”¨ Hexo å†™ä¸€ä¸ªä¸ªäººåšå®¢,å¥ˆä½•æŠ€æœ¯ä¸å¤Ÿï¼Œåé¢å­¦ä¹ äº† react ï¼Œæ‰€ä»¥æœ‰äº†ç°åœ¨çš„ä¼Ÿä¼Ÿå°ä¸–ç•Œè¿™ä¸ªåšå®¢ç³»ç»Ÿäº†ã€‚è¯¥åšå®¢æ˜¯æˆ‘ä¸ªäººæ˜¯ä½¿ç”¨çš„ä¸å…·æœ‰é€šç”¨æ€§ï¼Œä»¥é”»ç‚¼æˆ‘çš„èƒ½åŠ›è€Œåšï¼Œçœ‹çœ‹å°±å¥½ã€‚

## ç®€ä»‹

è¯¥åšå®¢é‡‡ç”¨ Jamstack

ä»€ä¹ˆæ˜¯ jamstack?

<details>
    <sumary>Jamstck</sumarry>
        <p>Jamstack æ˜¯ä¸€ç§æ„å»ºç½‘ç«™å’Œ web åº”ç”¨ç¨‹åºçš„æ–°æ–¹æ³•ã€‚Jamstack çš„ Stack æŒ‡çš„æ˜¯è®¸å¤šç‹¬ç«‹ï¼Œä½†æ˜¯å¯ä»¥ç»„åˆçš„æŠ€æœ¯æ ˆã€‚å½“å®ƒä»¬ç»“åˆåœ¨ä¸€èµ·æ—¶èƒ½å¤Ÿæä¾›ä¸€ä¸ªå®Œæ•´çš„ web åº”ç”¨ã€‚<br/>Jamstack æ¶æ„ä¸­çš„ JAM æ˜¯æŒ‡å®¢æˆ·ç«¯ JavaScriptã€å¯é‡ç”¨çš„åç«¯ APIï¼Œå’Œç”¨æˆ·ç•Œé¢çš„ Markupï¼Œæ¯”å¦‚ HTML ä¸ CSSã€‚</p>
</details>

å­¦ä¹ Reactä¹‹åå°±å¸Œæœ›è‡ªå·±å†™ä¸€ä¸ªåšå®¢ï¼Œç°åœ¨æ—¶æœºæˆç†Ÿï¼Œæ‰€ä»¥æœ‰äº†ç°åœ¨çš„åšå®¢ã€‚

ä¸»è¦é‡‡ç”¨äº†gatsby + reactæŠ€æœ¯æ ˆã€‚[gatsbyä¼ é€é—¨](https://www.gatsbyjs.cn/)

## ä»“åº“åœ°å€
**æ¼”ç¤ºåœ°å€ä¸ºæ—§ç‰ˆæœ¬æ²¡æœ‰å’Œä»“åº“å†…å®¹ä¿æŒåŒæ­¥ï¼Œ2022å¹´å†æ›´æ”¹**
æ¼”ç¤ºåœ°å€: [ä¼Ÿä¼Ÿå°ä¸–ç•Œ](https://weiwei.web.cloudendpoint.cn/)
ä»“åº“åœ°å€: [GitHub]()


## æ–‡æ¡£å¤§çº²


```
- src
  |- articles ç”¨æ¥æ”¾è‡ªå·±æ–‡ç« 
    |- æ•°é‡è¾ƒå¤šä¸å±•ç¤º
  |- component ç”¨æ¥æ”¾ä¸€äº›ç»„ä»¶
    |- Header.js
    |- Layout.js
    |- RightSide.js
    |- Footer.js
    |= all.css
  |- images
    |- iconå›¾ç‰‡ä¹‹ç±»
  |- pages  ä¸»è¦çš„é¡µé¢
    |- 404.js
    |- about.js
    |- friendLink.js
    |- index.js
    |- tags.js
    |- page.css
  |- styles å…¨å±€çš„cssæ–‡ä»¶
    |- Animation.css
    |- global.css
  |- templates  
    |- blogpost.js
    |- Pgae.js
- gatsby-browser.js
- gatsby-config.js
- package.json
- README.md
```

## ç”¨åˆ°çš„æŠ€æœ¯ / å·¥å…·

ğŸ”– åšå®¢ä¸»è¦ä½¿ç”¨åˆ°çš„æŠ€æœ¯

å‰ç«¯ (åšå®¢é¡µé¢)

    - React 
    - gatsby cli
    - Antd ç»„ä»¶åº“
    - 


## ä¸»è¦åŠŸèƒ½

- é¦–é¡µé¢„è§ˆæ‰€æœ‰æ–‡ç« 
- æŸ¥çœ‹æ–‡ç« è¯„è®ºã€å‘å¸ƒè¯„è®ºã€è¯„è®ºå›å¤
- æœç´¢æ–‡ç« ï¼šæ ¹æ®å…³é”®å­—æœç´¢ã€åˆ†ç±»æœç´¢ã€æ ‡ç­¾æœç´¢
- æŸ¥çœ‹ç›¸å†Œ
- æŸ¥çœ‹è¯´è¯´
- æŸ¥çœ‹ç•™è¨€æ¿ç•™è¨€ã€å‘å¸ƒç•™è¨€ã€ç•™è¨€å›å¤
- æŸ¥çœ‹å‹é“¾ã€è®¿é—®å‹é“¾
- æŸ¥çœ‹å°ä½œå“
- æŸ¥çœ‹å»ºç«™æ—¥å¿—æ—¶é—´è½´
- æŸ¥çœ‹å…³äºæœ¬ç«™/å…³äºæˆ‘


## å»ºç«™è®°å½•

## é‡åˆ°é—®é¢˜:

1. æ–‡ç« è¯¦æƒ…é¡µï¼Œæ— æ³•ä¿®æ”¹æ ·å¼


2. å®šä¹‰åœ¨header ç»„ä»¶ä¸­ä¸­ä¸€ä¸ªæŒ‰é’®ï¼Œæ§åˆ¶ä¾§è¾¹æ çš„æ˜¾ç¤º / éšè— 

è§£å†³: çˆ¶ä¸å­é€šä¿¡ ï¼Œ åœ¨layoutå®šä¹‰ä¸€ä¸ªå‡½æ•°é€šè¿‡propsä¼ é€’ç»™ headerç»„ä»¶

3. ç”¨window.innerWidth æ¥åˆ¤æ–­é¡µé¢çš„å®½åº¦ , åªæ˜¯åœ¨åˆå§‹åŠ è½½çš„æ—¶å€™ç”Ÿæ•ˆï¼ŒåæœŸå†æ”¹å˜é¡µé¢å®½åº¦ä¸ç”Ÿæ•ˆ

4. é¡µé¢å¼¹å‡ºé®ç½©å±‚æ—¶ï¼Œé¡µé¢è¿˜æ˜¯å¯ä»¥æ»šåŠ¨æˆ–æ»‘åŠ¨

è§£å†³:

5. gatsby ç‰ˆæœ¬æ—§ ç”±V3 å‡çº§ v4 ç‰ˆæœ¬

è§£å†³:

```
1. npm outdated / yarn upgrade-interactive
   è‡ªåŠ¨å‡çº§åˆ°v3çš„æœ€æ–°ç‰ˆæœ¬(æˆ‘ä½¿ç”¨npm outdated æ˜¯åˆ—å‡ºæ¥ç‰ˆæœ¬å·®å¼‚,æˆ‘è‡ªå·±åœ¨package.json ä¸­ä¿®æ”¹ç‰ˆæœ¬);

2. npm install gatsby@latest
   åœ¨npm ç‰ˆæœ¬ä½äº7 ä½¿ç”¨è¿™ä¸ª

  npm install gatsby@latest --legacy-peer-deps
  npm >= 7 ä½¿ç”¨ä¸Šé¢çš„è¯­å¥

```

[è§£å†³æ–¹æ³•çš„ç½‘ç«™](https://www.gatsbyjs.com/docs/reference/release-notes/migrating-from-v3-to-v4/)

6. æ— æ³•è®¾ç½®é¡µé¢ç›®å½• ? (å·²ç»è·å–åˆ° æ ‡é¢˜çš„ é”šç‚¹é“¾æ¥,å•å‡»æ²¡æœ‰ååº”)

    åœ¨F12 åçœ‹åˆ°æ ‡é¢˜é‚£æ²¡æœ‰è®¾ç½®é”šç‚¹ , åæ¥è§£å†³åŠæ³•æ˜¯ä½¿ç”¨å¦ä¸€ä¸ªæ’ä»¶ç”Ÿæˆé”šç‚¹

```
  npm install --save gatsby-remark-autolink-headers

  // In your gatsby-config.js
module.exports = {
  plugins: [
    {
      resolve: `gatsby-transformer-remark`,
      options: {
        plugins: [`gatsby-remark-autolink-headers`],
      },
    },
  ],
}

```

prismjs æ’ä»¶ä¸ autolink æœ‰è¿·ä¹‹å†²çªï¼Œä¸€å®šè¦æŠŠ autolink æ”¾å‰ï¼Œprismjs æ”¾åï¼š

// good
{
  resolve: `gatsby-transformer-remark`,
  options: {
    plugins: [
      `gatsby-remark-autolink-headers`,
      `gatsby-remark-prismjs`,
    ],
  },
}
 
// bad
{
  resolve: `gatsby-transformer-remark`,
  options: {
    plugins: [
      `gatsby-remark-prismjs`, // should be placed after `gatsby-remark-autolink-headers`
      `gatsby-remark-autolink-headers`,
    ],
  },
}
æ·»åŠ æˆåŠŸåç”± md æ–‡ä»¶è½¬æ¢å¾—åˆ°çš„ html å­—ç¬¦ä¸²é‡Œçš„æ ‡é¢˜å°±ä¼šéƒ½å¸¦ä¸Š idï¼Œè¿™æ ·é”šé“¾æ¥å°±èƒ½æ­£å¸¸ä½¿ç”¨å•¦ï¼


7. æŠ¥é”™

```
react_devtools_backend.js:2540 Warning: Can't perform a React state update on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in a useEffect cleanup function.
```

åŸå› æ˜¯åœ¨åŸé¡µé¢è®¾ç½®äº†å–æ¶ˆscroll


8. æŠ¥é”™

Can't perform a React state update on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in a useEffect cleanup function.

æ— æ³•å¯¹å¸è½½çš„ç»„ä»¶æ‰§è¡Œ React çŠ¶æ€æ›´æ–°ã€‚ è¿™æ˜¯ä¸€ä¸ªç©ºæ“ä½œï¼Œä½†å®ƒè¡¨æ˜æ‚¨çš„åº”ç”¨ç¨‹åºä¸­å­˜åœ¨å†…å­˜æ³„æ¼ã€‚ è¦ä¿®å¤ï¼Œè¯·å–æ¶ˆ useEffect æ¸…ç†å‡½æ•°ä¸­çš„æ‰€æœ‰è®¢é˜…å’Œå¼‚æ­¥ä»»åŠ¡ã€‚

è§£å†³åŠæ³•:

å‚è€ƒ

[https://blog.csdn.net/u010565037/article/details/88716681](https://blog.csdn.net/u010565037/article/details/88716681)

[https://stackoverflow.com/questions/53949393/cant-perform-a-react-state-update-on-an-unmounted-component](https://stackoverflow.com/questions/53949393/cant-perform-a-react-state-update-on-an-unmounted-component)


```js

  let [sideShow, setsideShow] = useState(false);
  // æ­¤å¤„
  let mounted = true;
  let sideShowBtn = () => {
    if(mounted) {
      // æ­¤å¤„
      setsideShow(!sideShow);
    }
    
    sideShow
      ? (document.documentElement.style.overflow = "scroll")
      : (document.documentElement.style.overflow = "hidden");
  };

  useEffect(()=>{
    // å¸è½½é¡µé¢çš„æ—¶å€™ ä½¿ç”¨æ­¤å‡½æ•°
    return function cleanUp() {
      mounted = false;
    }
  },[])



```

ä»¥ä¸Šçš„é—®é¢˜è¿˜å‡ºç°åœ¨åˆ‡æ¢fixedçŠ¶æ€é‚£

```js


 useEffect(() => {
    let active = true;
    let flag = false;
    
      const header = document.querySelector(".headerContainer");
      window.addEventListener("scroll", () => {
        window.pageYOffset >= header.clientHeight
          ? flag = true
          : flag = false;

          if(active) settofix(flag);
      });

    return function cleanUp() {
      active = false;
    }
  },[]);
```
